


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://insper.github.io/SistemasHardwareSoftware/aulas/13-entrada-saida/">
      
      
        <meta name="author" content="Igor Montagner">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.6">
    
    
      
        <title>13 - Entrada/Saída - Sistemas Hardware-Software - 2020/2</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.63b94e9e.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7f672a1f.min.css">
      
      
        
        
        <meta name="theme-color" content="#795548">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/printing.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="brown" data-md-color-accent="amber">
  
    
      <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#13-entradasaida" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      











<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->

<script>
  window.site_url = "https://insper.github.io/SistemasHardwareSoftware/";
</script>

<div class="md-printing-header">
  <img class="cabecalho" src="https://insper.github.io/SistemasHardwareSoftware/css/cabecalho.png">
  <img class="logo" src="https://insper.github.io/SistemasHardwareSoftware/css/logo.png">

  <div class="frontmatter">
    <div class="materia"> Sistemas Hardware-Software </div>
    <div class="professor"> Igor Montagner </div>
    <div class="semestre"> 2020/2 </div>
  </div>
</div>

<header class="md-header" data-md-component="header">

  <!-- Top-level navigation -->
  <nav class="md-header-nav md-grid" aria-label="Header">

    <!-- Link to home -->
    <a
      href="https://insper.github.io/SistemasHardwareSoftware/"
      title="Sistemas Hardware-Software - 2020/2"
      class="md-header-nav__button md-logo"
      aria-label="Sistemas Hardware-Software - 2020/2"
    >
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Sistemas Hardware-Software - 2020/2
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              13 - Entrada/Saída
            
          </span>
        </div>
      
    </div>

    <!-- Button to open search dialogue -->
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>

      <!-- Search interface -->
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository containing source -->
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/insper/sistemashardwaresoftware/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sistemashardwaresoftware
  </div>
</a>
      </div>
    
  </nav>
</header>




    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://insper.github.io/SistemasHardwareSoftware/" title="Sistemas Hardware-Software - 2020/2" class="md-nav__button md-logo" aria-label="Sistemas Hardware-Software - 2020/2">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Sistemas Hardware-Software - 2020/2
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/insper/sistemashardwaresoftware/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sistemashardwaresoftware
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../sobre/" title="Burocracias" class="md-nav__link">
      Burocracias
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Aulas
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Aulas" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Aulas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../01-introducao/" title="01 e 02 - Exercícios de C" class="md-nav__link">
      01 e 02 - Exercícios de C
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02-inteiros/" title="02 - Inteiros na CPU" class="md-nav__link">
      02 - Inteiros na CPU
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03-ram/" title="03 - Representação de dados em RAM" class="md-nav__link">
      03 - Representação de dados em RAM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04-asm-1/" title="04 - Registradores x64 e variáveis globais" class="md-nav__link">
      04 - Registradores x64 e variáveis globais
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05-funcoes/" title="05 - Funções" class="md-nav__link">
      05 - Funções
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06-condicionais/" title="06 - Condicionais" class="md-nav__link">
      06 - Condicionais
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07-loops/" title="07 - Loops" class="md-nav__link">
      07 - Loops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08-variaveis-locais/" title="08 - Variáveis locais" class="md-nav__link">
      08 - Variáveis locais
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09-arrays/" title="09 - Array em Assembly" class="md-nav__link">
      09 - Array em Assembly
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10-malloc/" title="10 - Alocação Dinâmica de Memória" class="md-nav__link">
      10 - Alocação Dinâmica de Memória
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../11-tipos-de-dados/" title="11 - Tipos abstratos de dados" class="md-nav__link">
      11 - Tipos abstratos de dados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../12-linux-do-zero/" title="12 - Linux do Zero" class="md-nav__link">
      12 - Linux do Zero
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        13 - Entrada/Saída
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="13 - Entrada/Saída" class="md-nav__link md-nav__link--active">
      13 - Entrada/Saída
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trabalhando-com-arquivos" class="md-nav__link">
    Trabalhando com arquivos
  </a>
  
    <nav class="md-nav" aria-label="Trabalhando com arquivos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra" class="md-nav__link">
    Extra
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissoes-e-posse-de-arquivos" class="md-nav__link">
    Permissões e posse de arquivos
  </a>
  
    <nav class="md-nav" aria-label="Permissões e posse de arquivos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra_1" class="md-nav__link">
    Extra
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../14-processos/" title="14 - Processos" class="md-nav__link">
      14 - Processos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../15-exec/" title="15 - Carregamento de programas" class="md-nav__link">
      15 - Carregamento de programas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../99-corretor-automatico/" title="99 - Corretor Automático" class="md-nav__link">
      99 - Corretor Automático
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Projetos
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Projetos" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Projetos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/bomblab/" title="Bomb Lab" class="md-nav__link">
      Bomb Lab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projetos/posix/" title="Linux do Zero" class="md-nav__link">
      Linux do Zero
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trabalhando-com-arquivos" class="md-nav__link">
    Trabalhando com arquivos
  </a>
  
    <nav class="md-nav" aria-label="Trabalhando com arquivos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra" class="md-nav__link">
    Extra
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissoes-e-posse-de-arquivos" class="md-nav__link">
    Permissões e posse de arquivos
  </a>
  
    <nav class="md-nav" aria-label="Permissões e posse de arquivos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra_1" class="md-nav__link">
    Extra
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/insper/sistemashardwaresoftware/edit/master/docs/aulas/13-entrada-saida/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="13-entradasaida">13 - Entrada/Saída<a class="headerlink" href="#13-entradasaida" title="Permanent link">&para;</a></h1>
<h2 id="trabalhando-com-arquivos">Trabalhando com arquivos<a class="headerlink" href="#trabalhando-com-arquivos" title="Permanent link">&para;</a></h2>
<p>Nesta seção trabalharemos com as chamadas <code>open</code>, <code>close</code>, <code>read</code> e <code>write</code>.</p>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Leia o código do arquivo <code>exemplo_io1.c</code>. O quê ele faz?</p>
</div>
<p>Vamos agora usar o comando <code>man</code> para ver a documentação das chamadas de sistema do Linux. Digite no terminal <code>man read</code>. A tela mostrada contém a documentação da função <code>read</code>, incluindo sua assinatura e quais cabeçalhos devem ser incluídos para que ela possa ser usada.</p>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Usando como apoio a documentação aberta pelo comando <code>man</code>, como saber que um arquivo foi lido até o fim?</p>
<p><strong>Dica</strong>: a seção <code>RETURN VALUE</code> pode te ajudar.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Para acelerar suas buscas no <code>man</code> você pode ativar a busca pressinando <code>/</code>. Aí basta digitar o termo procurado. Para avançar para as próximas ocorrências de um termo basta apertar <code>/</code> + <code>Enter</code>.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Baseado em sua resposta acima, modifique <code>exemplo_io1.c</code> para que ele mostre o arquivo inteiro. Para ficar melhor de visualizar o resultado, faça o <code>printf</code> interno mostrar somente o caractere lido.</p>
</div>
<p>Vamos agora trabalhar com a chamada <code>write</code>. Um exemplo de seu uso está mostrado no arquivo <code>exemplo_io2.c</code>.</p>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Abra o arquivo <code>exemplo_io2.c</code> e explique abaixo como usar <code>write</code>.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Crie um programa <code>copy_file</code> que lê dois nomes de arquivos usando <code>scanf</code> e copia o conteúdo do primeiro para o segundo. Ou seja, você deverá abrir ambos arquivos (cada um terá seu próprio <em>file descriptor</em>), ler do primeiro para um buffer e escrever este buffer no segundo.</p>
</div>
<h3 id="extra">Extra<a class="headerlink" href="#extra" title="Permanent link">&para;</a></h3>
<p>Estes exercícios não terão correção durante a aula e devem ser checados no atendimento. Faça-os se você já acabou os anteriores e a correção/discussão ainda não começou.</p>
<p>Até agora trabalhamos com um buffer com somente um caractere. Isso facilita a programação, mas deixa nosso código muito lento.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Modifique o <code>copy_file</code> para usar um buffer de 100 caracteres. Meça o tempo de execução para a cópia de um arquivo grande (~100Mb) usando o comando <code>time</code>. Não se esqueça de verificar que os resultados ficaram iguais com o comando <code>diff</code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Não sabe como usar <code>time</code> ou <code>diff</code>? Use o comando <code>man</code> visto acima. Não sabe usar <code>man</code>? Use o comando <code>man</code> para aprender a usá-lo com <code>man man</code></p>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Use o manual para entender o significado dos tempos mostrados pelo comando <code>time</code>. Escreva abaixo seu entendimento.</p>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Você consegue explicar a diferença de desempenho entre as duas versões?</p>
</div>
<h2 id="permissoes-e-posse-de-arquivos">Permissões e posse de arquivos<a class="headerlink" href="#permissoes-e-posse-de-arquivos" title="Permanent link">&para;</a></h2>
<p>No <code>exemplo_io2.c</code> passamos algumas opções extras para poder criar o arquivo:</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">fd1</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">arq1</span><span class="p">,</span> <span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">O_CREAT</span><span class="p">,</span> <span class="mo">0700</span><span class="p">);</span>
</code></pre></div>
<p>A flag <code>O_CREAT</code> é usada para indicar que o arquivo deve ser criado caso ele não exista. O número <code>0700</code> representa os bits de acesso visto na expositiva. Cada dígito contém 3 dígitos que representam as seguintes permissões</p>
<ul>
<li>4 - permissão de leitura</li>
<li>2 - permissão de escrita</li>
<li>1 - permissão de execução</li>
</ul>
<p>O primeiro dígito contém as permissões do usuário dono do arquivo. O segundo dígito contém as permissões do grupo dono do arquivo. Usuários que pertencem a este grupo possuem estas permissões. O terceiro dígito lista as permissões para todos os outros usuários.</p>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Use <code>ls -l</code> na pasta do arquivo criado por <code>copy_file</code> (ou por <code>exemplo_io2</code>). Onde é possível obter as informações de permissões do arquivo? Qual o usuário e grupo donos do arquivo? As permissões passadas para o <code>open</code> foram corretamente colocadas no arquivo?</p>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Quais permissões são garantidas pela máscara <code>640</code>? É uma boa ideia usá-la? \vspace{5em}</p>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Qual máscara usaria se quisesse que um arquivo possa ser modificado somente por seu dono, mas possa ser executado por qualquer usuário do sistema (incluindo o dono do arquivo)? Justifique.</p>
</div>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Rode o comando <code>copy_file</code> usando <code>sudo</code>. Use <code>ls -l</code> para listar as informações do arquivo. Escreva abaixo quem é seu dono e suas permissões de acesso.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Use os comandos <code>chown</code> para mudar o dono do arquivo para seu usuário e <code>chmod</code> para deixar suas permissões como leitura e escrita para você e somente leitura para o restante.</p>
<p><strong>Dica</strong>: não sabe como usar os comandos acima? Use <code>man</code>.</p>
</div>
<h3 id="extra_1">Extra<a class="headerlink" href="#extra_1" title="Permanent link">&para;</a></h3>
<p>Estes exercícios trabalham com o conceito de posse de arquivos e de sobrescrita de arquivos já existentes.</p>
<div class="admonition question short">
<p class="admonition-title">Question</p>
<p>Tente usar <code>copy_file</code> usando como fonte algum arquivo que você não possui acesso de leitura (você pode criá-lo e depois usar <code>chmod</code> para editar os acessos). O quê ocorre? Você consegue explicar este comportamento?</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Conserte o erro ocorrido acima checando a saída de <code>open</code>. Consulte o manual caso necessário. Não se esqueça de fazê-lo para o arquivo fonte e destino.</p>
</div>
<div class="admonition question medium">
<p class="admonition-title">Question</p>
<p>Vamos realizar um experimento neste exercício:</p>
<ol>
<li>Crie um arquivo com 100 caracteres <em>a</em> e chame-o de <code>100a</code>;</li>
<li>Crie um arquivo com 3 caracteres <em>b</em> e chame-o de <code>3b</code>;</li>
<li>Use <code>copy_file</code> para copiar <code>3b</code> em cima de <code>100a</code>;</li>
<li>Mostre o conteúdo do arquivo sobrescrito <code>100a</code>.</li>
</ol>
<p>Você consegue explicar o que ocorreu? Se sim, busque no manual uma flag que, ao ser passada para o <code>open</code>, evita que isto ocorra.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>O <code>copy_file</code> sobrescreve arquivos sem dó. Use o manual para encontrar a flag que faz <code>open</code> falhar caso o arquivo de destino já exista e conserte seu programa para perguntar se o usuário deseja sobrescrever o arquivo. Note que isto conflita com seu exercício 6. Entenda como usar <code>errno</code> para que você consiga diferenciar os dois tipos de erros.</p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../12-linux-do-zero/" title="12 - Linux do Zero" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                12 - Linux do Zero
              </div>
            </div>
          </a>
        
        
          <a href="../14-processos/" title="14 - Processos" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                14 - Processos
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d1f5a259.min.js"></script>
      <script src="../../assets/javascripts/bundle.d5fec882.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.fae956e7.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../../translate-admonitions.js"></script>
      
    
  </body>
</html>